<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DentNord - Digital Dental Solutions</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    /* Reset and Base Styles */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      line-height: 1.6;
      color: #333;
      overflow-x: hidden;
    }

    .container {
      width: 100%;
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
    }

    /* Header Styles */
    header {
      background: #fff;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      position: fixed;
      width: 100%;
      top: 0;
      z-index: 1000;
    }

    .header-container {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 0;
    }

    .logo {
      font-size: 28px;
      font-weight: 700;
      color: #0056b3;
      text-decoration: none;
    }

    .logo span {
      color: #00a8e8;
    }

    nav ul {
      display: flex;
      list-style: none;
    }

    nav ul li {
      margin-left: 30px;
    }

    nav ul li a {
      text-decoration: none;
      color: #333;
      font-weight: 500;
      transition: color 0.3s;
    }

    nav ul li a:hover {
      color: #0056b3;
    }

    .cta-button {
      background: #0056b3;
      color: white;
      padding: 10px 20px;
      border-radius: 30px;
      text-decoration: none;
      font-weight: 600;
      transition: background 0.3s;
    }

    .cta-button:hover {
      background: #004494;
    }

    /* Hero Section */
    #hero {
      background: linear-gradient(135deg, #0056b3 0%, #00a8e8 100%);
      color: white;
      padding: 150px 0 100px;
      text-align: center;
    }

    .hero-content {
      max-width: 800px;
      margin: 0 auto;
    }

    #hero h1 {
      font-size: 48px;
      margin-bottom: 20px;
      font-weight: 700;
    }

    #hero p {
      font-size: 20px;
      margin-bottom: 30px;
      opacity: 0.9;
    }

    .hero-buttons {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-top: 30px;
    }

    .btn {
      padding: 12px 30px;
      border-radius: 30px;
      text-decoration: none;
      font-weight: 600;
      transition: all 0.3s;
      display: inline-block;
    }

    .btn-primary {
      background: white;
      color: #0056b3;
    }

    .btn-primary:hover {
      background: #f0f0f0;
      transform: translateY(-3px);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }

    .btn-secondary {
      background: transparent;
      color: white;
      border: 2px solid white;
    }

    .btn-secondary:hover {
      background: white;
      color: #0056b3;
      transform: translateY(-3px);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }

    /* Section Styles */
    section {
      padding: 80px 0;
    }

    .section-header {
      text-align: center;
      margin-bottom: 60px;
    }

    .section-header h2 {
      font-size: 36px;
      color: #0056b3;
      margin-bottom: 15px;
    }

    .section-header p {
      color: #666;
      max-width: 700px;
      margin: 0 auto;
    }

    /* About Section */
    #about {
      background: #f8f9fa;
    }

    .about-content {
      display: flex;
      align-items: center;
      gap: 50px;
    }

    .about-text {
      flex: 1;
    }

    .about-text h3 {
      font-size: 28px;
      margin-bottom: 20px;
      color: #0056b3;
    }

    .about-text p {
      margin-bottom: 20px;
    }

    .about-image {
      flex: 1;
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }

    .about-image img {
      width: 100%;
      height: auto;
      display: block;
    }

    /* Services Section */
    .service-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 30px;
    }

    .service-card {
      background: white;
      border-radius: 10px;
      padding: 30px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
      transition: transform 0.3s, box-shadow 0.3s;
      text-align: center;
    }

    .service-card:hover {
      transform: translateY(-10px);
      box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
    }

    .service-icon {
      font-size: 40px;
      color: #0056b3;
      margin-bottom: 20px;
    }

    .service-card h3 {
      font-size: 22px;
      margin-bottom: 15px;
      color: #0056b3;
    }

    /* Pricing Section */
    #pricing {
      background: #f8f9fa;
    }

    #pricing .service-card {
      padding: 40px;
    }

    .price-options {
      margin-top: 20px;
    }

    .price-option {
      margin: 15px 0;
      padding: 15px;
      border-radius: 8px;
      background: #f8f9fa;
    }

    .price-option h4 {
      color: #333;
      margin-bottom: 10px;
    }

    .price {
      font-size: 24px;
      color: #0056b3;
      font-weight: bold;
    }

    /* Upload Section */
    #upload {
      background: #f8f9fa;
    }

    .upload-container {
      max-width: 800px;
      margin: 0 auto;
      background: white;
      padding: 40px;
      border-radius: 10px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
    }

    .upload-form {
      display: grid;
      gap: 20px;
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
    }

    .form-group input,
    .form-group textarea,
    .form-group select {
      width: 100%;
      padding: 12px 15px;
      border: 1px solid #ddd;
      border-radius: 5px;
      font-size: 16px;
    }

    .form-group textarea {
      min-height: 120px;
      resize: vertical;
    }

    .file-upload {
      border: 2px dashed #ddd;
      border-radius: 5px;
      padding: 30px;
      text-align: center;
      cursor: pointer;
      transition: border-color 0.3s;
    }

    .file-upload:hover {
      border-color: #0056b3;
    }

    .file-upload i {
      font-size: 40px;
      color: #0056b3;
      margin-bottom: 10px;
    }

    .submit-btn {
      background: #0056b3;
      color: white;
      border: none;
      padding: 15px 30px;
      border-radius: 30px;
      font-size: 18px;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.3s;
    }

    .submit-btn:hover {
      background: #004494;
    }

    /* Contact Section */
    .contact-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 40px;
    }

    .contact-info {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .contact-item {
      display: flex;
      align-items: flex-start;
      gap: 15px;
    }

    .contact-icon {
      font-size: 24px;
      color: #0056b3;
    }

    /* Footer */
    footer {
      background: #00264d;
      color: white;
      padding: 60px 0 30px;
    }

    .footer-content {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 40px;
      margin-bottom: 40px;
    }

    .footer-column h3 {
      font-size: 20px;
      margin-bottom: 20px;
      color: #00a8e8;
    }

    .footer-links {
      list-style: none;
    }

    .footer-links li {
      margin-bottom: 10px;
    }

    .footer-links a {
      color: #ccc;
      text-decoration: none;
      transition: color 0.3s;
    }

    .footer-links a:hover {
      color: white;
    }

    .social-links {
      display: flex;
      gap: 15px;
      margin-top: 20px;
    }

    .social-links a {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 40px;
      height: 40px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 50%;
      color: white;
      transition: background 0.3s;
    }

    .social-links a:hover {
      background: #00a8e8;
    }

    .copyright {
      text-align: center;
      padding-top: 30px;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
      color: #ccc;
    }

    /* Responsive Styles */
    @media (max-width: 768px) {
      .header-container {
        flex-direction: column;
        padding: 15px 0;
      }

      nav ul {
        margin-top: 15px;
        flex-wrap: wrap;
        justify-content: center;
      }

      nav ul li {
        margin: 5px 10px;
      }

      #hero h1 {
        font-size: 36px;
      }

      #hero p {
        font-size: 18px;
      }

      .about-content {
        flex-direction: column;
      }

      .hero-buttons {
        flex-direction: column;
        align-items: center;
      }

      .btn {
        width: 100%;
        max-width: 250px;
        text-align: center;
      }
    }

    /* Status Popups (Loading, Success, Error) */
    .status-popup {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 2000;
      animation: fadeIn 0.3s ease;
    }

    .status-popup-content {
      background: white;
      padding: 40px;
      border-radius: 15px;
      box-shadow: 0 5px 25px rgba(0, 0, 0, 0.15);
      width: 90%;
      max-width: 400px;
      text-align: center;
      animation: slideIn 0.4s ease-out;
    }

    .status-title {
      font-size: 22px;
      color: #0056b3;
      margin: 20px 0 10px;
    }

    .status-popup-content p {
      color: #666;
      line-height: 1.6;
    }

    .status-close-btn {
      background: #0056b3;
      color: white;
      border: none;
      padding: 12px 30px;
      border-radius: 25px;
      margin-top: 25px;
      cursor: pointer;
      transition: background 0.3s;
      font-weight: 500;
      font-size: 16px;
    }

    .status-close-btn:hover {
      background: #004494;
    }

    .loading-spinner {
      width: 50px;
      height: 50px;
      border: 4px solid #f0f0f0;
      border-top: 4px solid #0056b3;
      border-radius: 50%;
      margin: 0 auto;
      animation: spin 1s linear infinite;
    }

    .success-checkmark, .error-icon {
      font-size: 60px;
      margin: 0 auto;
    }
    .success-checkmark { color: #28a745; }
    .error-icon { color: #dc3545; }


    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    @keyframes slideIn {
      from { opacity: 0; transform: translateY(-20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }
  </style>
</head>
<body>
  <!-- Header -->
  <header>
    <div class="container header-container">
      <a href="#" class="logo">Dent<span>Nord</span></a>
      <nav>
        <ul>
          <li><a href="#home">Home</a></li>
          <li><a href="#about">About</a></li>
          <li><a href="#services">Services</a></li>
          <li><a href="#pricing">Pricing</a></li>
          <li><a href="#upload">Upload</a></li>
          <li><a href="#contact">Contact</a></li>
          <li><a href="#upload" class="cta-button">Get Started</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <!-- Hero Section -->
  <section id="hero">
    <div class="container hero-content">
      <h1>Digital Solutions for Modern Dentistry</h1>
      <p>Innovative, compliant, and patient-focused designs for dental professionals across Europe.</p>
      <div class="hero-buttons">
        <a href="#upload" class="btn btn-primary">Upload Files</a>
        <a href="#services" class="btn btn-secondary">Our Services</a>
      </div>
    </div>
  </section>

  <!-- About Section -->
  <section id="about">
    <div class="container">
      <div class="about-content">
        <div class="about-text">
          <h3>About DentNord</h3>
          <p>DentNord provides digital dental design services for clinics and labs across Europe. Our platform enables dentists to upload scans and imaging, and quickly receive high-quality STL files for crowns, bridges, surgical guides, and more.</p>
          <p>With years of experience in digital dentistry, our team of experts ensures precision, quality, and timely delivery for all your dental design needs.</p>
          <a href="#contact" class="btn btn-primary">Contact Us</a>
        </div>
        <div class="about-image">
          
          <!-- Placeholder for dental image -->
            <div class="about-image-slider" style="position: relative; width: 100%; height: 400px; border-radius: 10px; overflow: hidden;">
            <img src="images/surgery.jpg.jpg" alt="Dental Technology 1" class="slider-img" style="width:100%; height:400px; object-fit:cover; border-radius:10px; position:absolute; top:0; left:0; opacity:1; transition:opacity 1s;">
            <img src="images/implant1.jpg.png" alt="Dental Technology 2" class="slider-img" style="width:100%; height:400px; object-fit:cover; border-radius:10px; position:absolute; top:0; left:0; opacity:0; transition:opacity 1s;">
            <img src="images/implant2.jpg.png" alt="Dental Technology 3" class="slider-img" style="width:100%; height:400px; object-fit:cover; border-radius:10px; position:absolute; top:0; left:0; opacity:0; transition:opacity 1s;">
            
            <img src="images/surgery.jpg.jpg" alt="Dental Technology 5" class="slider-img" style="width:100%; height:400px; object-fit:cover; border-radius:10px; position:absolute; top:0; left:0; opacity:0; transition:opacity 1s;">
             <img src="istockphoto .jpg" alt="Dental Technology 5" class="slider-img" style="width:100%; height:400px; object-fit:cover; border-radius:10px; position:absolute; top:0; left:0; opacity:0; transition:opacity 1s;">
            </div>
            </div>
          </div>
          <script>
            // Simple image slider for About section
            (function() {
              const images = document.querySelectorAll('.about-image-slider .slider-img');
              let current = 0;
              setInterval(() => {
                images[current].style.opacity = 0;
                current = (current + 1) % images.length;
                images[current].style.opacity = 1;
              }, 3000);
            })();
          </script>
        </div>
      </div>
    </div>
  </section>

  <!-- Services Section -->
  <section id="services">
    <div class="container">
      <div class="section-header">
        <h2>Our Services</h2>
        <p>Comprehensive digital dental solutions tailored to your practice needs</p>
      </div>
      <div class="service-grid">
        <div class="service-card">
          <div class="service-icon">
            <i class="fas fa-tooth"></i>
          </div>
          <h3>3D Design</h3>
          <p>Custom STL designs for crowns, bridges, and prosthetics with precision and accuracy.</p>
        </div>
        <div class="service-card">
          <div class="service-icon">
            <i class="fas fa-syringe"></i>
          </div>
          <h3>Surgical Guides</h3>
          <p>Precise guides for safe and efficient implant placement procedures.</p>
        </div>
        <div class="service-card">
          <div class="service-icon">
            <i class="fas fa-file-medical"></i>
          </div>
          <h3>File Management</h3>
          <p>Upload, store, and retrieve patient STL files securely with our encrypted system.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Pricing Section -->
  <section id="pricing">
    <div class="container">
      <div class="section-header">
        <h2>üí∞ Surgical Guide Pricing</h2>
        <p>Transparent pricing for all your dental guide needs</p>
      </div>
      <div class="service-grid">
        <div class="service-card">
          <h3>Single Implant Guide</h3>
          <div class="price-options">
        <div class="price-option">
          <h4>Planning Only</h4>
          <p class="price">‚Ç¨50</p>
        </div>
        <div class="price-option">
          <h4>+ 3D Printed Guide with Sleeve</h4>
          <p class="price">‚Ç¨110</p>
        </div>
          </div>
        </div>
        <div class="service-card">
          <h3>Two Implant Guide</h3>
          <div class="price-options">
        <div class="price-option">
          <h4>Planning Only</h4>
          <p class="price">‚Ç¨60</p>
        </div>
        <div class="price-option">
          <h4>+ 3D Printed Guide with Sleeve</h4>
          <p class="price">‚Ç¨135</p>
        </div>
          </div>
        </div>
        <div class="service-card">
          <h3>Four-Implant Edentulous Guides</h3>
          <div class="price-options">
        <div class="price-option">
          <h4>Planning Only</h4>
          <p class="price">‚Ç¨300</p>
        </div>
        <div class="price-option">
          <h4> + 3D Printed Guide with Sleeve</h4>
          <p class="price">‚Ç¨600</p>
        </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Upload Section -->
  <section id="upload">
    <div class="container">
      <div class="section-header">
        <h2>Upload Files</h2>
        <p>Securely submit your dental scans and receive professional designs</p>
      </div>
      <div class="upload-container">
        <form class="upload-form" id="uploadForm" action="https://script.google.com/macros/s/AKfycbz3RGdCE9cfSmBVU5cX7kCIoV7vOHgY0VdPo9EKNsH7KkiFB8-C999BZ71DIntFwnGn/exec" method="POST" enctype="multipart/form-data">
          <div class="form-group">
            <label for="doctor">Your Name</label>
            <input type="text" id="doctor" name="name" placeholder="Dr. John Smith" required>
          </div>
          <div class="form-group">
            <label for="email">Email Address</label>
            <input type="email" id="email" name="email" placeholder="your.email@example.com" required>
          </div>
          <div class="form-group">
            <label for="clinic">Clinic Name</label>
            <input type="text" id="clinic" name="clinic" placeholder="Your Dental Clinic" required>
          </div>
          <div class="form-group">
            <label for="service">Service Required</label>
            <select id="service" name="service" required>
              <option value="">Select a service</option>
              <option value="crown">Crown Design</option>
              <option value="bridge">Bridge Design</option>
              <option value="implant-guide">Surgical Guide</option>
              <option value="prosthetic">Prosthetic Design</option>
              <option value="other">Other</option>
            </select>
          </div>
          <div class="form-group">
            <label for="notes">Additional Notes</label>
            <textarea id="notes" name="message" placeholder="Any specific requirements or instructions..."></textarea>
          </div>
          <div class="form-group">
            <label>Upload Files</label>
            <div class="file-upload">
              <i class="fas fa-cloud-upload-alt"></i>
              <p id="upload-text">Click to upload or drag and drop</p>
              <p>STL, DICOM, 3D scan files, and compressed archives (ZIP, RAR, 7Z)</p>
              <input type="file" id="attach" name="attach" accept=".stl,.dcm,.obj,.ply,.zip,.rar,.7z,.tar,.gz,.tar.gz" multiple required>
            </div>
          </div>
          <button type="submit" class="submit-btn">Submit Files</button>
        </form>
      </div>
    </div>
  </section>

  <!-- Contact Section -->
  <section id="contact">
    <div class="container">
      <div class="section-header">
        <h2>Contact Us</h2>
        <p>Get in touch with our dental solutions team</p>
      </div>
      <div class="contact-container">
        <div class="contact-info">
          <div class="contact-item">
            <div class="contact-icon">
              <i class="fas fa-map-marker-alt"></i>
            </div>
            <div>
              <h3>Our Location</h3>
              <p>   odense , Denmark</p>
            </div>
          </div>
          <div class="contact-item">
            <div class="contact-icon">
              <i class="fas fa-phone"></i>
            </div>
            <div>
              <h3>Phone Number</h3>
              <p>+4571635150</p>
            </div>
          </div>
          <div class="contact-item">
            <div class="contact-icon">
              <i class="fas fa-envelope"></i>
            </div>
            <div>
              <h3>Email Address</h3>
              <p>info.dentnord@gmail.com</p>
            </div>
          </div>
          <div class="contact-item">
            <div class="contact-icon">
              <i class="fas fa-clock"></i>
            </div>
            <div>
              <h3>Working Hours</h3>
              <p>üöÄ We don‚Äôt do ‚Äúclosing hours.‚Äù We do ‚Äúalways.‚Äù</p>
            </div>
          </div>
        </div>
  </section>

  <!-- Footer -->
  <footer>
    <div class="container">
    </div>
  </footer>

  <script>
// Chunked upload configuration - Even smaller chunks for better reliability
const CHUNK_SIZE = 1 * 1024 * 1024; // 1MB chunks (very conservative)

// Generate unique session ID for chunked uploads
function generateSessionId() {
  return Date.now().toString(36) + Math.random().toString(36).substr(2);
}

// Check if file should use chunked upload
function shouldUseChunkedUpload(file) {
  return file.size > CHUNK_SIZE;
}

// Upload file in chunks for large files
function uploadFileInChunks(file, formData, sessionId) {
  return new Promise((resolve, reject) => {
    const totalChunks = Math.ceil(file.size / CHUNK_SIZE);
    let uploadedChunks = 0;
    
    function uploadChunk(chunkIndex) {
      return new Promise((chunkResolve, chunkReject) => {
        const start = chunkIndex * CHUNK_SIZE;
        const end = Math.min(start + CHUNK_SIZE, file.size);
        const chunk = file.slice(start, end);
        
        const reader = new FileReader();
        reader.onload = function(e) {
          const chunkData = {
            action: 'uploadChunk',
            fileName: file.name,
            chunkIndex: chunkIndex,
            totalChunks: totalChunks,
            chunkData: e.target.result.split(',')[1], // Base64 data
            sessionId: sessionId,
            formData: {
              name: formData.get('name'),
              email: formData.get('email'),
              clinic: formData.get('clinic'),
              service: formData.get('service'),
              message: formData.get('message')
            }
          };
          
          fetch(document.getElementById('uploadForm').action, {
            method: 'POST',
            body: JSON.stringify(chunkData),
            headers: {
              'Content-Type': 'text/plain;charset=utf-8',
            },
          })
          .then(response => response.json())
          .then(result => {
            if (result.success) {
              uploadedChunks++;
              
              // Update progress
              const progress = (uploadedChunks / totalChunks) * 100;
              updateUploadProgress(file.name, progress, uploadedChunks, totalChunks);
              
              if (result.isComplete) {
                chunkResolve(result);
              } else {
                chunkResolve({ success: true, progress: progress });
              }
            } else {
              chunkReject(new Error(result.error || 'Chunk upload failed'));
            }
          })
          .catch(chunkReject);
        };
        
        reader.onerror = () => chunkReject(new Error('Failed to read file chunk'));
        reader.readAsDataURL(chunk);
      });
    }
    
    // Upload chunks sequentially to avoid overwhelming the server
    async function uploadAllChunks() {
      try {
        for (let i = 0; i < totalChunks; i++) {
          const result = await uploadChunk(i);
          if (result.isComplete) {
            resolve(result);
            return;
          }
        }
      } catch (error) {
        reject(error);
      }
    }
    
    uploadAllChunks();
  });
}

// Update progress display
function updateUploadProgress(fileName, progress, current, total) {
  const loadingDiv = document.querySelector('.status-popup');
  if (loadingDiv) {
    const progressText = loadingDiv.querySelector('.status-title');
    const progressDetails = loadingDiv.querySelector('p');
    if (progressText) {
      progressText.textContent = `Uploading: ${fileName}`;
    }
    if (progressDetails) {
      progressDetails.innerHTML = `
        Progress: ${Math.round(progress)}% (${current}/${total} chunks)<br>
        Large files are uploaded in secure chunks for reliability.
      `;
    }
  }
}

// Format file size for display
function formatFileSize(bytes) {
  if (bytes === 0) return '0 Bytes';
  const k = 1024;
  const sizes = ['Bytes', 'KB', 'MB', 'GB'];
  const i = Math.floor(Math.log(bytes) / Math.log(k));
  return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
}

// Smooth scrolling for navigation links
document.querySelectorAll('a[href^="#"]').forEach(anchor => {
  anchor.addEventListener('click', function (e) {
    e.preventDefault();
    document.querySelector(this.getAttribute('href')).scrollIntoView({
      behavior: 'smooth'
    });
  });
});

// File selection display handler
const fileInput = document.getElementById('attach');
if (fileInput) {
  fileInput.addEventListener('change', function() {
    const files = this.files;
    const fileUpload = this.parentElement;
    const fileInfo = fileUpload.querySelector('p');

    if (files.length > 0) {
      let totalSize = Array.from(files).reduce((sum, file) => sum + file.size, 0);
      let largeFiles = Array.from(files).filter(file => shouldUseChunkedUpload(file));
      
      let displayText = `${files.length} file(s) selected (${formatFileSize(totalSize)})`;
      if (largeFiles.length > 0) {
        displayText += `\n${largeFiles.length} large file(s) will use chunked upload`;
      }
      
      fileInfo.textContent = displayText;
      fileInfo.style.color = '#333';
      fileInfo.style.whiteSpace = 'pre-line';
    } else {
      fileInfo.innerHTML = 'Click to upload or drag and drop';
      fileInfo.style.color = '#666';
      fileInfo.style.whiteSpace = 'normal';
    }
  });
}

// Enhanced form submission handler with chunked upload support
const uploadForm = document.getElementById('uploadForm');
if (uploadForm) {
  uploadForm.addEventListener('submit', async function(e) {
    e.preventDefault();

    const form = this;
    const fileInput = document.getElementById('attach');
    const submitButton = form.querySelector('button[type="submit"]');
    let loadingDiv = null;

    // Check if files are selected
    if (fileInput.files.length === 0) {
      const errorDiv = document.createElement('div');
      errorDiv.className = 'status-popup';
      errorDiv.innerHTML = `
        <div class="status-popup-content">
            <div class="error-icon">
              <i class="fas fa-times-circle"></i>
            </div>
            <h3 class="status-title">No Files Selected</h3>
            <p>Please select at least one file to upload.</p>
            <button class="status-close-btn">Close</button>
        </div>`;
      document.body.appendChild(errorDiv);
      errorDiv.querySelector('.status-close-btn').addEventListener('click', () => {
        errorDiv.remove();
      });
      return;
    }

    submitButton.disabled = true;

    const files = Array.from(fileInput.files);
    const formData = new FormData(form);
    const sessionId = generateSessionId();
    
    // Analyze files for upload strategy
    const smallFiles = files.filter(file => !shouldUseChunkedUpload(file));
    const largeFiles = files.filter(file => shouldUseChunkedUpload(file));
    
    // Show loading indicator
    loadingDiv = document.createElement('div');
    loadingDiv.className = 'status-popup';
    loadingDiv.innerHTML = `
      <div class="status-popup-content">
        <div class="loading-spinner"></div>
        <h3 class="status-title">Preparing Upload...</h3>
        <p>Processing ${files.length} file(s).<br>
        ${smallFiles.length} small files, ${largeFiles.length} large files (chunked upload)</p>
      </div>`;
    document.body.appendChild(loadingDiv);

    try {
      const results = [];
      
      // Upload small files first (batch upload)
      if (smallFiles.length > 0) {
        const smallFilesData = await Promise.all(
          smallFiles.map((file, index) => {
            return new Promise((resolve, reject) => {
              const reader = new FileReader();
              reader.onload = (event) => {
                resolve({
                  fileName: file.name,
                  mimeType: file.type,
                  data: event.target.result.split(',')[1],
                  fileIndex: index
                });
              };
              reader.onerror = () => reject(new Error(`Failed to read file: ${file.name}`));
              reader.readAsDataURL(file);
            });
          })
        );
        
        const submissionData = {
          files: smallFilesData,
          formData: {
            name: formData.get('name'),
            email: formData.get('email'),
            clinic: formData.get('clinic'),
            service: formData.get('service'),
            message: formData.get('message')
          }
        };
        
        const response = await fetch(form.action, {
          method: 'POST',
          body: JSON.stringify(submissionData),
          headers: {
            'Content-Type': 'text/plain;charset=utf-8',
          },
        });
        
        const result = await response.json();
        if (result.success) {
          results.push(...(result.files || []));
        } else {
          throw new Error(result.error || 'Small files upload failed');
        }
      }

      // Upload large files individually with chunked upload
      for (const file of largeFiles) {
        const result = await uploadFileInChunks(file, formData, sessionId + '_' + file.name);
        if (result.success && result.files) {
          results.push(...result.files);
        }
      }

      // Remove loading indicator
      if (loadingDiv) loadingDiv.remove();

      // Show success message
      const successDiv = document.createElement('div');
      successDiv.className = 'status-popup';
      successDiv.innerHTML = `
        <div class="status-popup-content">
          <div class="success-checkmark">
            <i class="fas fa-check-circle"></i>
          </div>
          <h3 class="status-title">Upload Successful!</h3>
          <p style="margin-bottom: 15px;">All ${files.length} file(s) have been uploaded successfully!</p>
          <div style="text-align: left; font-size: 14px; color: #666;">
            <p>‚úì Small files: ${smallFiles.length} (batch upload)</p>
            <p>‚úì Large files: ${largeFiles.length} (chunked upload)</p>
          </div>
          ${results.length > 0 ? 
            `<div style="max-height: 100px; overflow-y: auto; margin-top: 15px;">
              ${results.map(file => `<p style="font-size: 12px;"><strong>${file.name}</strong></p>`).join('')}
            </div>` : ''}
          <button class="status-close-btn">Close</button>
        </div>`;
      document.body.appendChild(successDiv);

      successDiv.querySelector('.status-close-btn').addEventListener('click', () => {
        successDiv.remove();
      });

      form.reset();
      const fileInfo = form.querySelector('.file-upload p');
      if(fileInfo) {
        fileInfo.innerHTML = 'Click to upload or drag and drop';
        fileInfo.style.color = '#666';
        fileInfo.style.whiteSpace = 'normal';
      }

    } catch (error) {
      console.error('Error:', error);
      if (loadingDiv) loadingDiv.remove();

      // Show error message
      const errorDiv = document.createElement('div');
      errorDiv.className = 'status-popup';
      errorDiv.innerHTML = `
        <div class="status-popup-content">
            <div class="error-icon">
              <i class="fas fa-times-circle"></i>
            </div>
            <h3 class="status-title">Upload Failed</h3>
            <p>An error occurred: ${error.message}</p>
            <p style="font-size: 12px; color: #666;">Please try again or contact support if the problem persists.</p>
            <button class="status-close-btn">Close</button>
        </div>`;
      document.body.appendChild(errorDiv);
      errorDiv.querySelector('.status-close-btn').addEventListener('click', () => {
        errorDiv.remove();
      });
    } finally {
      submitButton.disabled = false;
    }
  });
}
</script>

</body>
</html>
